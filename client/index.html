<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

    <!-- HilltopAds Verification -->
    <meta name="c045d1e64e59d25588a1c35c736232f048ace685" content="c045d1e64e59d25588a1c35c736232f048ace685" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FD791XES9C"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-FD791XES9C');
    </script>

    <!-- SEO Meta Tags -->
    <meta name="description" content="StreamFlix - Plateforme de streaming légal pour films et séries. Découvrez des milliers de contenus en haute qualité, sans publicité, avec un accès illimité 24h/24. Abonnez-vous dès maintenant !" />
    <meta name="keywords" content="streamflix, streaming, films, séries, streaming légal, cinéma, divertissement, vidéo à la demande, VOD, films gratuits, séries gratuites, streaming sans publicité" />

    <!-- Preload critical assets -->
    <link rel="preload" href="/src/assets/logo.svg" as="image" />
    
    <title>StreamFlix - Streaming Légal Films et Séries</title>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    
    <script type="module" src="/src/main.tsx"></script>
    
    <script>
      // PWA Installation handling
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then((registration) => {
              console.log('[PWA] Service Worker registered with scope:', registration.scope);
            })
            .catch((error) => {
              console.log('[PWA] Service Worker registration failed:', error);
            });
        });

        // Handle PWA install prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
          // Prevent the mini-infobar from appearing on mobile
          e.preventDefault();
          // Stash the event so it can be triggered later
          deferredPrompt = e;

          // Show custom install button or notification
          console.log('[PWA] App can be installed');

          // You can dispatch a custom event to show install button
          window.dispatchEvent(new CustomEvent('pwa-installable'));
        });

        // Handle successful installation
        window.addEventListener('appinstalled', (e) => {
          console.log('[PWA] App was installed successfully');
          deferredPrompt = null;
        });
      }

      // Handle online/offline status
      window.addEventListener('online', () => {
        console.log('[PWA] Connection restored');
        // You can show a notification or update UI here
      });

      window.addEventListener('offline', () => {
        console.log('[PWA] Connection lost');
        // You can show a notification or update UI here
      });
    </script>
  </body>
</html>